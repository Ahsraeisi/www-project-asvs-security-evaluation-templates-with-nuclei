id: ASVS-4-0-3-V12-3-3

info:
  name: ASVS 12.3.3 Check
  author: AmirHossein Raeisi
  severity: high
  classification:
    cwe-id: CWE-918, CWE-98
  reference:
    - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.2-Testing_for_Remote_File_Inclusion
    - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/19-Testing_for_Server-Side_Request_Forgery
    - https://snbig.github.io/Vulnerable-Pages/ASVS_12_3_3/

  tags: asvs,12.3.3

  description: |
    Verify that user-submitted filename metadata is validated or ignored to prevent the disclosure or execution of remote files via Remote File Inclusion (RFI) or Server-side Request Forgery (SSRF) attacks.

http:
  - pre-condition:
      - type: dsl
        dsl:
          - 'method == "GET"'

    payloads:
      rfi:
        - "https://snbig.github.io/Vulnerable-Pages/ASVS_12_3_3/rfi.txt"
        - "https://{{interactsh-url}}"

    fuzzing:
      - part: query
        mode: single
        fuzz:
          - "{{rfi}}"

    stop-at-first-match: true
    matchers:
      - type: word
        part: body
        words:
          - "d5b82f27-b7a4-4c3e-8b6e-88fd9e97b16a"

      - type: word
        part: interactsh_protocol
        words:
          - "http"
          - "dns"

# digest: 4a0a00473045022100f368aa244774591af8882b0c7558e7485ad5e80a2b19d50188c9f93bde0f41a8022054eeb86288f988a190ba7eb40f538583653238ff2c07bc6118b4e7414fd11d40:236a7c23afe836fbe231d6e037cff444